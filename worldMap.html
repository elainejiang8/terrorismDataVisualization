<!DOCTYPE html>
<html>
<head>
    <style>
        .active {fill: blue !important;}
    </style>
    <link rel="stylesheet" href="worldMap.css">
    <link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet">
</head>
<body>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script src="/datamaps.world.min.js"></script>
    <script src="/jquery-3.1.1.min.js"></script>
    <div id = "title" style="position: relative; z-index: 2;">
        <div class="types">
            Frequencies of Terrorist Attacks in Countries by Target Type<br>
            1970-2015<br>
            <span class="type_label"></span>
            <button id="education" name="button" class="types type_label">Education</button>
            <button id="religion" name="button" class="types type_label">Religion</button>
            <button id="telecomm" name="button" class="types type_label">Telecommunication</button>
            <button id="media" name="button" class="types type_label">Media</button>
            <button id="ngo" name="button" class="types type_label">NGO</button>
        </div>
    </div>
    <div id="container" style="position: relative; padding: 120px 0px 0px; margin-top: -120px; z-index: 1;">
        
    </div>
    <script>
        var countries = [];
        var values = [];
        d3.csv("testData.csv", function(rows) {
           rows.map(function(d) {
              countries.push(d.country);
              values.push(d.value);
           })
//           
            var dataset = {};
//            var minValue = Math.min.apply(null, values), maxValue = Math.max.apply(null, values);
//            
//            var paletteScale = d3.scale.linear()
//                .domain([minValue, maxValue])
//                .range(["#C5D5E0", "#042F4D"]); 
//            
//            for(var i = 0; i < countries.length; i++) {
//                if(values[i] == 0) {
//                    dataset[countries[i]] = {number: values[i], fillColor: "#F5F5F5"};
//                } else {
//                    dataset[countries[i]] = {number: values[i], fillColor: paletteScale(values[i])};
//                }
//            }
//           
            var map = new Datamap({element: document.getElementById("container"),
            projection: 'mercator',
            responsive: true,
            fills: {
                defaultFill: "#F5F5F5",
            },  
            
            data: dataset,
                
            
            geographyConfig: {
            borderColor: '#DEDEDE',
            highlightFillColor: "#833D3F",
            highlightBorderWidth: 1,
           
            // show desired information in tooltip
            popupTemplate: function(geo, data) {
                // don't show tooltip if country don't present in dataset
                if (!data) {return ['<div class="hoverinfo">',
                    '<strong>', geo.properties.name,
                    '</div>'].join(''); }
                // tooltip content
                return ['<div class="hoverinfo">',
                    '<strong>', geo.properties.name, '</strong>',
                    '<br>Count: <strong>', data.number, '</strong>',
                    '</div>'].join('');
            }
            }
            });
            window.addEventListener('resize', function(event){
                map.resize();
            });
           
       
        
        $(document).ready(function() {
            // religion
            $("#religion").click(function(){
            d3.csv("religion.csv", function(rows) {
                rows.map(function(d) {
                countries.push(d.country);
                values.push(d.value);
            })
           
            var dataset = {};
            var minValue = Math.min.apply(null, values), maxValue = Math.max.apply(null, values);
            
            var paletteScale = d3.scale.linear()
                .domain([minValue, maxValue])
                .range(["#C5D5E0", "#042F4D"]); 
            
            for(var i = 0; i < countries.length; i++) {
                if(values[i] == 0) {
                    dataset[countries[i]] = {number: values[i], fillColor: "#F5F5F5"};
                } else {
                    dataset[countries[i]] = {number: values[i], fillColor: paletteScale(values[i])};
                }
            }
                map.updateChoropleth(dataset);
            }); 
            
            
            });
            
            // education
            $("#education").click(function(){
            d3.csv("testData.csv", function(rows) {
                rows.map(function(d) {
                countries.push(d.country);
                values.push(d.value);
            })
           
            var dataset = {};
            var minValue = Math.min.apply(null, values), maxValue = Math.max.apply(null, values);
            
            var paletteScale = d3.scale.linear()
                .domain([minValue, maxValue])
                .range(["#C5D5E0", "#042F4D"]); 
            
            for(var i = 0; i < countries.length; i++) {
                if(values[i] == 0) {
                    dataset[countries[i]] = {number: values[i], fillColor: "#F5F5F5"};
                } else {
                    dataset[countries[i]] = {number: values[i], fillColor: paletteScale(values[i])};
                }
            }
                map.updateChoropleth(dataset);
            }); 
            
            
            });
            
            
            // telecom
            $("#telecomm").click(function(){
            d3.csv("telecomm.csv", function(rows) {
                rows.map(function(d) {
                countries.push(d.country);
                values.push(d.value);
            })
           
            var dataset = {};
            var minValue = Math.min.apply(null, values), maxValue = Math.max.apply(null, values);
            
            var paletteScale = d3.scale.linear()
                .domain([minValue, maxValue])
                .range(["#C5D5E0", "#042F4D"]); 
            
            for(var i = 0; i < countries.length; i++) {
                if(values[i] == 0) {
                    dataset[countries[i]] = {number: values[i], fillColor: "#F5F5F5"};
                } else {
                    dataset[countries[i]] = {number: values[i], fillColor: paletteScale(values[i])};
                }
            }
                map.updateChoropleth(dataset);
            }); 
            
            
            });
            
            // media
            $("#media").click(function(){
            d3.csv("media.csv", function(rows) {
                rows.map(function(d) {
                countries.push(d.country);
                values.push(d.value);
            })
           
            var dataset = {};
            var minValue = Math.min.apply(null, values), maxValue = Math.max.apply(null, values);
            
            var paletteScale = d3.scale.linear()
                .domain([minValue, maxValue])
                .range(["#C5D5E0", "#042F4D"]); 
            
            for(var i = 0; i < countries.length; i++) {
                if(values[i] == 0) {
                    dataset[countries[i]] = {number: values[i], fillColor: "#F5F5F5"};
                } else {
                    dataset[countries[i]] = {number: values[i], fillColor: paletteScale(values[i])};
                }
            }
                map.updateChoropleth(dataset);
            }); 
            
            
            });
            
            
            // ngo
            $("#ngo").click(function(){
            d3.csv("ngo.csv", function(rows) {
                rows.map(function(d) {
                countries.push(d.country);
                values.push(d.value);
            })
           
            var dataset = {};
            var minValue = Math.min.apply(null, values), maxValue = Math.max.apply(null, values);
            
            var paletteScale = d3.scale.linear()
                .domain([minValue, maxValue])
                .range(["#C5D5E0", "#042F4D"]); 
            
            for(var i = 0; i < countries.length; i++) {
                if(values[i] == 0) {
                    dataset[countries[i]] = {number: values[i], fillColor: "#F5F5F5"};
                } else {
                    dataset[countries[i]] = {number: values[i], fillColor: paletteScale(values[i])};
                }
            }
                map.updateChoropleth(dataset);
            }); 
            
            
            });
            
        });
    });
        
        
    </script>
</body>
</html>